{"ts":1356716418878,"silentsave":true,"restoring":false,"patch":[[]],"length":0}
{"contributors":[],"silentsave":false,"ts":1356716423205,"patch":[[{"diffs":[[1,"var conn = require('./conf').conn;\nvar http = require('http');\n\nvar options = {\n  host: 'search.twitter.com',\n  path: '/search.json?q=%23bbmp&page=1&rpp=8&include_entities=true&callback=?',\n  accep: 'application/json'\n};\n\nvar insertCallback = function(response) {\n  var str = '';\n\n  //another chunk of data has been recieved, so append it to `str`\n  response.on('data', function (chunk) {\n    str += chunk;\n  });\n\n  response.on('end', function () {\n    var data = JSON.parse(str);\n    var tweets = [];\n\tfor (var i in data.results) {\n\t\ttweets.push({\n\t\t\tfrom_user: data.results[i].from_user,\n\t\t\tfrom_user_name: data.results[i].from_user_name,\n\t\t\ttext: data.results[i].text,\n\t\t\tentities: data.results[i].entities\n\t\t});\n\t}\n\t\n\tconn.collection('tweets').insert(tweets,  function(err, result) {\n\t\tif (err) console.dir(err);\n\t});\n  });\n}\n\n//====== EXPORTS ======\nexports.recache = function(req, res) { \n\tconn.collection('tweets').find().toArray(function(err, items){\n\t\tif (err) { console.dir(err); }\n\t\tvar tweets = [];\n\t\tfor (var i in items) {\n\t\t\tvar json = items[i].session;\n\t\t\ttweets.push(items[i]._id);\n\t\t\tconn.collection('tweets').remove({_id: items[i]._id}, function(err, result) { if (err) console.dir(err);} );\n\t\t}\n\t\t\n\t\thttp.request(options, insertCallback).end();\n\t});\n\t\n\tres.send(200, 'OK');\n}\n\nexports.items = function(req, res) {\n\tconn.collection('tweets').find().toArray(function(err, items){\n\t\tres.send(items);\n\t});\n}"]],"start1":0,"start2":0,"length1":0,"length2":1422}]],"length":1422,"saved":false}
{"ts":1356716433669,"patch":[[{"diffs":[[0,".recache"],[1,"Tweets"],[0," = funct"]],"start1":862,"start2":862,"length1":16,"length2":22}]],"length":1428,"saved":false}
{"ts":1356716437287,"patch":[[{"diffs":[[0,"ache"],[-1,"Tweets"],[0," = f"]],"start1":866,"start2":866,"length1":14,"length2":8}]],"length":1422,"saved":false}
{"ts":1356716456709,"patch":[[{"diffs":[[0,"};\n\nvar "],[-1,"insert"],[1,"tweets"],[0,"Callback"]],"start1":218,"start2":218,"length1":22,"length2":22},{"diffs":[[0,"ptions, "],[-1,"insert"],[1,"tweets"],[0,"Callback"]],"start1":1233,"start2":1233,"length1":22,"length2":22},{"diffs":[[0,");\n\t});\n"],[1,"    \n    \n"],[0,"\t\n\tres.s"]],"start1":1261,"start2":1261,"length1":16,"length2":26}]],"length":1432,"saved":false}
{"ts":1356716496544,"patch":[[{"diffs":[[0," });\n}\n\n"],[1,"var blogsCallback = function(response) {\n  var str = '';\n\n  //another chunk of data has been recieved, so append it to `str`\n  response.on('data', function (chunk) {\n    str += chunk;\n  });\n\n  response.on('end', function () {\n    var data = JSON.parse(str);\n    var blogs = [];\n    for (var i in data.responseData.feed.entries) {\n        blogs.push({\n    \t\ttitle: data.responseData.feed.link + ' - ' + data.responseData.feed.entries[i].title,\n\t\t\tlink: data.responseData.feed.entries[i].link,\n\t\t\tcontentSnippet: data.responseData.feed.entries[i].contentSnippet\n\t\t});\n\t}\n    conn.collection('blogs').insert(blogs,  function(err, result) {\n        if (err) console.dir(err);\n\t});\n  });\n}\n\n"],[0,"//======"]],"start1":823,"start2":823,"length1":16,"length2":702},{"diffs":[[0,"res) { \n"],[1,"    //tweets\n"],[0,"\tconn.co"]],"start1":1573,"start2":1573,"length1":16,"length2":29},{"diffs":[[0,");\n    \n"],[-1,""],[0,"    \n"],[1,"    //blogs\n    conn.collection('blogs').find().toArray(function(err, items){\n    \tif (err) { console.dir(err); }\n\t\tvar blogs = [];\n\t\tfor (var i in items) {\n\t\t\tvar json = items[i].session;\n\t\t\tblogs.push(items[i]._id);\n\t\t\tconn.collection('blogs').remove({_id: items[i]._id}, function(err, result) { if (err) console.dir(err);} );\n\t\t}\n        \n        var urls = [\n        \t'http://www.bbmp.com.br/?feed=rss2', \n    \t\t'http://globoesporte.globo.com/platb/ba-torcedor-bahia/feed/',\n    \t\t'http://www.semprebahia.com/feed/atom/',\n    \t\t'http://feeds.feedburner.com/bahiaco'\n    \t];\n        \n        for (var i in urls) {\n    \t\thttp.request({\n              host: 'ajax.googleapis.com',\n              path: '/ajax/services/feed/load?v=1.0&num=2&q=' + encodeURIComponent(urls[i]),\n              accep: 'application/json'\n            }, insertCallback).end();\n        }\n\t});\n"],[0,"\t\n\tres.s"]],"start1":1965,"start2":1965,"length1":21,"length2":888}]],"length":2998,"saved":false}
{"contributors":[],"silentsave":false,"ts":1356716600041,"patch":[[{"diffs":[[0,"uire('./"],[1,"../"],[0,"conf').c"]],"start1":14,"start2":14,"length1":16,"length2":19}]],"length":3001,"saved":false}
{"ts":1356716710084,"patch":[[{"diffs":[[0,");\n}"],[-1,"\n\nexports.items = function(req, res) {\n\tconn.collection('tweets').find().toArray(function(err, items){\n\t\tres.send(items);\n\t});\n}"]],"start1":2869,"start2":2869,"length1":132,"length2":4}]],"length":2873,"saved":false}
{"ts":1356716740386,"patch":[[{"diffs":[[0,");\n\n"],[-1,"var options = {\n  host: 'search.twitter.com',\n  path: '/search.json?q=%23bbmp&page=1&rpp=8&include_entities=true&callback=?',\n  accep: 'application/json'\n};\n\n"],[0,"var "]],"start1":63,"start2":63,"length1":166,"length2":8},{"diffs":[[0,"est("],[-1,"options"],[1,"{\n          host: 'search.twitter.com',\n          path: '/search.json?q=%23bbmp&page=1&rpp=8&include_entities=true&callback=?',\n          accep: 'application/json'\n        }"],[0,", tw"]],"start1":1772,"start2":1772,"length1":15,"length2":181},{"diffs":[[0,"     }, "],[-1,"insert"],[1,"blogs"],[0,"Callback"]],"start1":2810,"start2":2810,"length1":22,"length2":21}]],"length":2880,"saved":false}
{"contributors":[],"silentsave":false,"ts":1356716974543,"patch":[[{"diffs":[[0,"===\n"],[-1,"exports."],[1,"var "],[0,"reca"]],"start1":1382,"start2":1382,"length1":16,"length2":12},{"diffs":[[0,"ion("],[-1,"req, res"],[0,") { "]],"start1":1405,"start2":1405,"length1":16,"length2":8},{"diffs":[[0,"\t});\n\t\n\t"],[1,"//"],[0,"res.send"]],"start1":2838,"start2":2838,"length1":16,"length2":18},{"diffs":[[0,"00, 'OK');\n}"],[1,"\nrecache();"]],"start1":2858,"start2":2858,"length1":12,"length2":23}]],"length":2881,"saved":false}
{"ts":1356717019348,"patch":[[{"diffs":[[0,";\n}\n"],[-1,"recache("],[1,"console.log('begin');\nrecache();\nconsole.log('end'"],[0,");"]],"start1":2867,"start2":2867,"length1":14,"length2":56}]],"length":2923,"saved":false}
{"ts":1356717088796,"patch":[[{"diffs":[[0," ======\n"],[-1,"var "],[1,"exports."],[0,"recache "]],"start1":1378,"start2":1378,"length1":20,"length2":24},{"diffs":[[0,"unction("],[1,"req, res"],[0,") { \n   "]],"start1":1405,"start2":1405,"length1":16,"length2":24},{"diffs":[[0,"\t});\n\t\n\t"],[-1,"//"],[0,"res.send"]],"start1":2850,"start2":2850,"length1":18,"length2":16},{"diffs":[[0,");\n}"],[-1,"\nconsole.log('begin');\nrecache();\nconsole.log('end');"]],"start1":2876,"start2":2876,"length1":57,"length2":4}]],"length":2880,"saved":false}
{"ts":1356717154378,"patch":[[{"diffs":[[0,"\n\t});\n\t\n"],[1,"    console.log('recached!');\n"],[0,"\tres.sen"]],"start1":2849,"start2":2849,"length1":16,"length2":46}]],"length":2910,"saved":false}
{"ts":1356717245506,"patch":[[{"diffs":[[0,"exports."],[-1,"r"],[1,"doR"],[0,"ecache ="]],"start1":1386,"start2":1386,"length1":17,"length2":19}]],"length":2912,"saved":false}
{"ts":1356717260099,"patch":[[{"diffs":[[0,";\n\t\n"],[-1,"    console.log('recached!');\n"],[0,"\tres"]],"start1":2855,"start2":2855,"length1":38,"length2":8}]],"length":2882,"saved":false}
{"contributors":[],"silentsave":false,"ts":1356718403403,"patch":[[{"diffs":[[0," });\n}\n\n"],[1,"var newsCallback = function(response) {\n  var str = '';\n\n  //another chunk of data has been recieved, so append it to `str`\n  response.on('data', function (chunk) {\n    str += chunk;\n  });\n\n  response.on('end', function () {\n    var data = JSON.parse(str);\n    var blogs = [];\n    for (var i in data.responseData.feed.entries) {\n        blogs.push({\n        \ttitle: data.responseData.feed.link + ' - ' + data.responseData.feed.entries[i].title,\n\t\t\tlink: data.responseData.feed.entries[i].link,\n\t\t\tcontentSnippet: data.responseData.feed.entries[i].contentSnippet\n\t\t});\n\t}\n    conn.collection('news').insert(blogs,  function(err, result) {\n        if (err) console.dir(err);\n\t});\n  });\n}\n\n"],[0,"//======"]],"start1":1354,"start2":1354,"length1":16,"length2":703},{"diffs":[[0," }\n\t});\n"],[1,"    \n    //blogs\n    conn.collection('news').find().toArray(function(err, items){\n        if (err) { console.dir(err); }\n\t\tvar blogs = [];\n\t\tfor (var i in items) {\n\t\t\tvar json = items[i].session;\n\t\t\tblogs.push(items[i]._id);\n\t\t\tconn.collection('blogs').remove({_id: items[i]._id}, function(err, result) { if (err) console.dir(err);} );\n\t\t}\n        \n        var urls = [\n        \t'http://www.bbmp.com.br/?feed=rss2', \n    \t\t'http://globoesporte.globo.com/platb/ba-torcedor-bahia/feed/',\n    \t\t'http://www.semprebahia.com/feed/atom/',\n    \t\t'http://feeds.feedburner.com/bahiaco'\n    \t];\n        \n        for (var i in urls) {\n    \t\thttp.request({\n              host: 'ajax.googleapis.com',\n              path: '/ajax/services/feed/load?v=1.0&num=2&q=' + encodeURIComponent(urls[i]),\n              accep: 'application/json'\n            }, blogsCallback).end();\n        }\n\t});\n"],[0,"\t\n\tres.s"]],"start1":3536,"start2":3536,"length1":16,"length2":889}]],"length":4442,"saved":false}
{"ts":1356718420624,"patch":[[{"diffs":[[0,"p://"],[-1,"www.bbmp.com.br/?feed=rss2', \n    \t\t'http://globoesporte.globo.com/platb/ba-torcedor-bahia/feed/',\n    \t\t'http://www.semprebahia.com/feed/atom/',\n    \t\t'http://feeds.feedburner.com/bahiaco"],[1,"globoesporte.globo.com/servico/semantica/editorias/plantao/futebol/times/bahia/feed.rss"],[0,"'\n  "]],"start1":3927,"start2":3927,"length1":196,"length2":95}]],"length":4341,"saved":false}
{"ts":1356718467133,"patch":[[{"diffs":[[0,"ls = [\n        \t"],[1,"{q: "],[0,"'http://globoesp"]],"start1":3907,"start2":3907,"length1":32,"length2":36},{"diffs":[[0,"eed.rss'"],[1,", num: 10}"],[0,"\n    \t];"]],"start1":4015,"start2":4015,"length1":16,"length2":26},{"diffs":[[0,"/load?v=1.0&num="],[-1,"2"],[1,"'+urls[i].num+'"],[0,"&q=' + encodeURI"]],"start1":4185,"start2":4185,"length1":33,"length2":47},{"diffs":[[0,"omponent(urls[i]"],[1,".q"],[0,"),\n             "]],"start1":4233,"start2":4233,"length1":32,"length2":34}]],"length":4371,"saved":false}
{"contributors":[],"silentsave":false,"ts":1356718615133,"patch":[[{"diffs":[[0,"\n            }, "],[-1,"blog"],[1,"new"],[0,"sCallback).end()"]],"start1":4293,"start2":4293,"length1":36,"length2":35}]],"length":4370,"saved":false}
{"ts":1356718656572,"patch":[[{"diffs":[[0,"onn.collection('"],[-1,"blog"],[1,"new"],[0,"s').remove({_id:"]],"start1":3773,"start2":3773,"length1":36,"length2":35}]],"length":4369,"saved":false}
{"contributors":[],"silentsave":false,"ts":1356719800588,"patch":[[{"diffs":[[0,"um: "],[-1,"10"],[1,"6},\n            {q: 'http://www.semprebahia.com/feed/atom/', num:4"],[0,"}\n  "]],"start1":4025,"start2":4025,"length1":10,"length2":74}]],"length":4433,"saved":false}
{"ts":1356719825642,"patch":[[{"diffs":[[0,"       \t"],[1,"{q:"],[0,"'http://"]],"start1":3042,"start2":3042,"length1":16,"length2":19},{"diffs":[[0,"=rss2', "],[1,"num:2}, "],[0,"\n    \t\t"],[1,"{q:"],[0,"'http://"]],"start1":3082,"start2":3082,"length1":23,"length2":34},{"diffs":[[0,"/feed/',"],[1," num:2}, "],[0,"\n    \t\t"],[1,"{q:"],[0,"'http://"]],"start1":3162,"start2":3162,"length1":23,"length2":35},{"diffs":[[0,"/atom/',"],[1," num:2}, "],[0,"\n    \t\t"],[1,"{q:"],[0,"'http://"]],"start1":3221,"start2":3221,"length1":23,"length2":35},{"diffs":[[0,"bahiaco'"],[1,", num:2}"],[0,"\n    \t];"]],"start1":3277,"start2":3277,"length1":16,"length2":24}]],"length":4479,"saved":false}
{"ts":1356719834924,"patch":[[{"diffs":[[0,"=rss2', num:"],[-1,"2"],[1,"3"],[0,"}, \n    \t\t{q"]],"start1":3082,"start2":3082,"length1":25,"length2":25},{"diffs":[[0,"eed/atom/', num:"],[-1,"2"],[1,"3"],[0,"}, \n    \t\t{q:'ht"]],"start1":3218,"start2":3218,"length1":33,"length2":33}]],"length":4479,"saved":false}
{"ts":1356719851782,"patch":[[{"diffs":[[0,"atom/', num:"],[-1,"3"],[1,"2"],[0,"}, \n    \t\t{q"]],"start1":3222,"start2":3222,"length1":25,"length2":25}]],"length":4479,"saved":false}
{"ts":1356719860977,"patch":[[{"diffs":[[0,"2', num:"],[-1,"3"],[1,"2"],[0,"}, \n    "]],"start1":3086,"start2":3086,"length1":17,"length2":17}]],"length":4479,"saved":false}
{"ts":1356719876869,"patch":[[{"diffs":[[0,"1.0&num="],[-1,"2"],[1,"'+urls[i].num+'"],[0,"&q=' + e"]],"start1":3453,"start2":3453,"length1":17,"length2":31},{"diffs":[[0,"(urls[i]"],[1,".q"],[0,"),\n     "]],"start1":3501,"start2":3501,"length1":16,"length2":18}]],"length":4495,"saved":false}
{"ts":1356719928932,"patch":[[{"diffs":[[0,") {\n"],[-1,"\t\t\tvar json = items[i].session;\n"],[0,"\t\t\tb"]],"start1":2831,"start2":2831,"length1":40,"length2":8}]],"length":4463,"saved":false}
{"ts":1356719932249,"patch":[[{"diffs":[[0,") {\n"],[-1,"\t\t\tvar json = items[i].session;\n"],[0,"\t\t\tb"]],"start1":3734,"start2":3734,"length1":40,"length2":8}]],"length":4431,"saved":false}
{"ts":1356720077409,"patch":[[{"diffs":[[0,"    \t{q:"],[-1," "],[0,"'http://"]],"start1":3915,"start2":3915,"length1":17,"length2":16},{"diffs":[[0,"um: "],[-1,"6"],[1,"5"],[0,"},\n "]],"start1":4022,"start2":4022,"length1":9,"length2":9},{"diffs":[[0,"     {q:"],[-1," "],[1,"'http://esporte.uol.com.br/futebol/clubes/bahia.xml', num: 3},\n            {q:"],[0,"'http://"]],"start1":4037,"start2":4037,"length1":17,"length2":94},{"diffs":[[0,"num:"],[-1,"4"],[1,"2"],[0,"}\n  "]],"start1":4164,"start2":4164,"length1":9,"length2":9}]],"length":4507,"saved":false}
{"ts":1356720174073,"patch":[[{"diffs":[[0,"].contentSnippet"],[1," ? data.responseData.feed.entries[i].contentSnippet : data.responseData.feed.entries[i].title"],[0,"\n\t\t});\n\t}\n    co"]],"start1":1219,"start2":1219,"length1":32,"length2":125}]],"length":4600,"saved":false}
{"ts":1356720228589,"patch":[[{"diffs":[[0,"tSnippet"],[1," ? data.responseData.feed.entries[i].contentSnippet : data.responseData.feed.entries[i].titl"],[0,"\n\t\t});\n\t"]],"start1":2008,"start2":2008,"length1":16,"length2":108}]],"length":4692,"saved":false}
{"ts":1356720290827,"patch":[[{"diffs":[[0,"ppet"],[-1," ? data.responseData.feed.entries[i].contentSnippet : data.responseData.feed.entries[i].title"],[0,"\n\t\t}"]],"start1":1231,"start2":1231,"length1":101,"length2":8},{"diffs":[[0,"ppet"],[-1," ? data.responseData.feed.entries[i].contentSnippet : data.responseData.feed.entries[i].titl"],[0,"\n\t\t}"]],"start1":1919,"start2":1919,"length1":100,"length2":8}]],"length":4507,"saved":false}
{"ts":1356720392332,"patch":[[{"diffs":[[0,"um: "],[-1,"5"],[1,"7"],[0,"},\n "]],"start1":4022,"start2":4022,"length1":9,"length2":9},{"diffs":[[0,"7},\n            "],[1,"//"],[0,"{q:'http://espor"]],"start1":4026,"start2":4026,"length1":32,"length2":34},{"diffs":[[0,"atom/', num:"],[-1,"2"],[1,"3"],[0,"}\n    \t];\n  "]],"start1":4158,"start2":4158,"length1":25,"length2":25}]],"length":4509,"saved":false}
