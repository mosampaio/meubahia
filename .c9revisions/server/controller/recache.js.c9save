{"ts":1356716418878,"silentsave":true,"restoring":false,"patch":[[]],"length":0}
{"contributors":[],"silentsave":false,"ts":1356716423205,"patch":[[{"diffs":[[1,"var conn = require('./conf').conn;\nvar http = require('http');\n\nvar options = {\n  host: 'search.twitter.com',\n  path: '/search.json?q=%23bbmp&page=1&rpp=8&include_entities=true&callback=?',\n  accep: 'application/json'\n};\n\nvar insertCallback = function(response) {\n  var str = '';\n\n  //another chunk of data has been recieved, so append it to `str`\n  response.on('data', function (chunk) {\n    str += chunk;\n  });\n\n  response.on('end', function () {\n    var data = JSON.parse(str);\n    var tweets = [];\n\tfor (var i in data.results) {\n\t\ttweets.push({\n\t\t\tfrom_user: data.results[i].from_user,\n\t\t\tfrom_user_name: data.results[i].from_user_name,\n\t\t\ttext: data.results[i].text,\n\t\t\tentities: data.results[i].entities\n\t\t});\n\t}\n\t\n\tconn.collection('tweets').insert(tweets,  function(err, result) {\n\t\tif (err) console.dir(err);\n\t});\n  });\n}\n\n//====== EXPORTS ======\nexports.recache = function(req, res) { \n\tconn.collection('tweets').find().toArray(function(err, items){\n\t\tif (err) { console.dir(err); }\n\t\tvar tweets = [];\n\t\tfor (var i in items) {\n\t\t\tvar json = items[i].session;\n\t\t\ttweets.push(items[i]._id);\n\t\t\tconn.collection('tweets').remove({_id: items[i]._id}, function(err, result) { if (err) console.dir(err);} );\n\t\t}\n\t\t\n\t\thttp.request(options, insertCallback).end();\n\t});\n\t\n\tres.send(200, 'OK');\n}\n\nexports.items = function(req, res) {\n\tconn.collection('tweets').find().toArray(function(err, items){\n\t\tres.send(items);\n\t});\n}"]],"start1":0,"start2":0,"length1":0,"length2":1422}]],"length":1422,"saved":false}
{"ts":1356716433669,"patch":[[{"diffs":[[0,".recache"],[1,"Tweets"],[0," = funct"]],"start1":862,"start2":862,"length1":16,"length2":22}]],"length":1428,"saved":false}
{"ts":1356716437287,"patch":[[{"diffs":[[0,"ache"],[-1,"Tweets"],[0," = f"]],"start1":866,"start2":866,"length1":14,"length2":8}]],"length":1422,"saved":false}
{"ts":1356716456709,"patch":[[{"diffs":[[0,"};\n\nvar "],[-1,"insert"],[1,"tweets"],[0,"Callback"]],"start1":218,"start2":218,"length1":22,"length2":22},{"diffs":[[0,"ptions, "],[-1,"insert"],[1,"tweets"],[0,"Callback"]],"start1":1233,"start2":1233,"length1":22,"length2":22},{"diffs":[[0,");\n\t});\n"],[1,"    \n    \n"],[0,"\t\n\tres.s"]],"start1":1261,"start2":1261,"length1":16,"length2":26}]],"length":1432,"saved":false}
{"ts":1356716496544,"patch":[[{"diffs":[[0," });\n}\n\n"],[1,"var blogsCallback = function(response) {\n  var str = '';\n\n  //another chunk of data has been recieved, so append it to `str`\n  response.on('data', function (chunk) {\n    str += chunk;\n  });\n\n  response.on('end', function () {\n    var data = JSON.parse(str);\n    var blogs = [];\n    for (var i in data.responseData.feed.entries) {\n        blogs.push({\n    \t\ttitle: data.responseData.feed.link + ' - ' + data.responseData.feed.entries[i].title,\n\t\t\tlink: data.responseData.feed.entries[i].link,\n\t\t\tcontentSnippet: data.responseData.feed.entries[i].contentSnippet\n\t\t});\n\t}\n    conn.collection('blogs').insert(blogs,  function(err, result) {\n        if (err) console.dir(err);\n\t});\n  });\n}\n\n"],[0,"//======"]],"start1":823,"start2":823,"length1":16,"length2":702},{"diffs":[[0,"res) { \n"],[1,"    //tweets\n"],[0,"\tconn.co"]],"start1":1573,"start2":1573,"length1":16,"length2":29},{"diffs":[[0,");\n    \n"],[-1,""],[0,"    \n"],[1,"    //blogs\n    conn.collection('blogs').find().toArray(function(err, items){\n    \tif (err) { console.dir(err); }\n\t\tvar blogs = [];\n\t\tfor (var i in items) {\n\t\t\tvar json = items[i].session;\n\t\t\tblogs.push(items[i]._id);\n\t\t\tconn.collection('blogs').remove({_id: items[i]._id}, function(err, result) { if (err) console.dir(err);} );\n\t\t}\n        \n        var urls = [\n        \t'http://www.bbmp.com.br/?feed=rss2', \n    \t\t'http://globoesporte.globo.com/platb/ba-torcedor-bahia/feed/',\n    \t\t'http://www.semprebahia.com/feed/atom/',\n    \t\t'http://feeds.feedburner.com/bahiaco'\n    \t];\n        \n        for (var i in urls) {\n    \t\thttp.request({\n              host: 'ajax.googleapis.com',\n              path: '/ajax/services/feed/load?v=1.0&num=2&q=' + encodeURIComponent(urls[i]),\n              accep: 'application/json'\n            }, insertCallback).end();\n        }\n\t});\n"],[0,"\t\n\tres.s"]],"start1":1965,"start2":1965,"length1":21,"length2":888}]],"length":2998,"saved":false}
{"contributors":[],"silentsave":false,"ts":1356716600041,"patch":[[{"diffs":[[0,"uire('./"],[1,"../"],[0,"conf').c"]],"start1":14,"start2":14,"length1":16,"length2":19}]],"length":3001,"saved":false}
{"ts":1356716710084,"patch":[[{"diffs":[[0,");\n}"],[-1,"\n\nexports.items = function(req, res) {\n\tconn.collection('tweets').find().toArray(function(err, items){\n\t\tres.send(items);\n\t});\n}"]],"start1":2869,"start2":2869,"length1":132,"length2":4}]],"length":2873,"saved":false}
{"ts":1356716740386,"patch":[[{"diffs":[[0,");\n\n"],[-1,"var options = {\n  host: 'search.twitter.com',\n  path: '/search.json?q=%23bbmp&page=1&rpp=8&include_entities=true&callback=?',\n  accep: 'application/json'\n};\n\n"],[0,"var "]],"start1":63,"start2":63,"length1":166,"length2":8},{"diffs":[[0,"est("],[-1,"options"],[1,"{\n          host: 'search.twitter.com',\n          path: '/search.json?q=%23bbmp&page=1&rpp=8&include_entities=true&callback=?',\n          accep: 'application/json'\n        }"],[0,", tw"]],"start1":1772,"start2":1772,"length1":15,"length2":181},{"diffs":[[0,"     }, "],[-1,"insert"],[1,"blogs"],[0,"Callback"]],"start1":2810,"start2":2810,"length1":22,"length2":21}]],"length":2880,"saved":false}
{"contributors":[],"silentsave":false,"ts":1356716974543,"patch":[[{"diffs":[[0,"===\n"],[-1,"exports."],[1,"var "],[0,"reca"]],"start1":1382,"start2":1382,"length1":16,"length2":12},{"diffs":[[0,"ion("],[-1,"req, res"],[0,") { "]],"start1":1405,"start2":1405,"length1":16,"length2":8},{"diffs":[[0,"\t});\n\t\n\t"],[1,"//"],[0,"res.send"]],"start1":2838,"start2":2838,"length1":16,"length2":18},{"diffs":[[0,"00, 'OK');\n}"],[1,"\nrecache();"]],"start1":2858,"start2":2858,"length1":12,"length2":23}]],"length":2881,"saved":false}
{"ts":1356717019348,"patch":[[{"diffs":[[0,";\n}\n"],[-1,"recache("],[1,"console.log('begin');\nrecache();\nconsole.log('end'"],[0,");"]],"start1":2867,"start2":2867,"length1":14,"length2":56}]],"length":2923,"saved":false}
{"ts":1356717088796,"patch":[[{"diffs":[[0," ======\n"],[-1,"var "],[1,"exports."],[0,"recache "]],"start1":1378,"start2":1378,"length1":20,"length2":24},{"diffs":[[0,"unction("],[1,"req, res"],[0,") { \n   "]],"start1":1405,"start2":1405,"length1":16,"length2":24},{"diffs":[[0,"\t});\n\t\n\t"],[-1,"//"],[0,"res.send"]],"start1":2850,"start2":2850,"length1":18,"length2":16},{"diffs":[[0,");\n}"],[-1,"\nconsole.log('begin');\nrecache();\nconsole.log('end');"]],"start1":2876,"start2":2876,"length1":57,"length2":4}]],"length":2880,"saved":false}
{"ts":1356717154378,"patch":[[{"diffs":[[0,"\n\t});\n\t\n"],[1,"    console.log('recached!');\n"],[0,"\tres.sen"]],"start1":2849,"start2":2849,"length1":16,"length2":46}]],"length":2910,"saved":false}
{"ts":1356717245506,"patch":[[{"diffs":[[0,"exports."],[-1,"r"],[1,"doR"],[0,"ecache ="]],"start1":1386,"start2":1386,"length1":17,"length2":19}]],"length":2912,"saved":false}
{"ts":1356717260099,"patch":[[{"diffs":[[0,";\n\t\n"],[-1,"    console.log('recached!');\n"],[0,"\tres"]],"start1":2855,"start2":2855,"length1":38,"length2":8}]],"length":2882,"saved":false}
